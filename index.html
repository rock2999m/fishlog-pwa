<form id="fishForm">
  <input type="file" id="photo" name=""> <!-- name属性は空 or 削除 -->
  <input type="text" name="memo">
  <input type="text" name="species">
  <input type="text" name="size">
  <input type="text" name="date">
  <input type="text" name="place">
  <button type="submit">送信</button>
</form>
<div id="result"></div>
<script>
document.getElementById('fishForm').addEventListener('submit', function(e){
  e.preventDefault();

  const form = e.target;
  const formData = new FormData(form);

  const fileInput = document.getElementById('photo');
  const file = fileInput.files[0];

  if (file) {
    const reader = new FileReader();
    reader.onload = function(evt) {
      const base64 = evt.target.result.split(',')[1];
      formData.append('photo_base64', base64);
      formData.append('photo_name', file.name);

      // 確認ログ
      for (let pair of formData.entries()) {
        console.log(pair[0], pair[1]);
      }

      sendFormData(formData);
    };
    reader.readAsDataURL(file);
  } else {
    sendFormData(formData);
  }

  function sendFormData(fd) {
    fetch("https://script.google.com/macros/s/AKfycby2Hp3ZcykGabspLYwrWMJwA-u_HBAtAiZptWuHanhN0YLp2QKQEn9n8TWfR_-MpuYoTA/exec", {
      method: "POST",
      body: fd
    })
    .then(async res => {
      let resText = await res.text();
      document.getElementById('result').textContent = resText;
    });
  }
});
</script>
